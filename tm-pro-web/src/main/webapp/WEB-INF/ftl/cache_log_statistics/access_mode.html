<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- BootStrap Css -->
<link href="${rc.contextPath}/statics/ui-frame/css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
<!-- 字体图标 Css -->
<link href="${rc.contextPath}/statics/ui-frame/css/font-awesome.min93e3.css?v=4.4.0" rel="stylesheet">
<!-- BootStrap 日期插件 -->
<link href="${rc.contextPath}/statics/ui-frame/css/plugins/datapicker/datepicker3.css" rel="stylesheet">
<!-- Css 动画 -->
<link href="${rc.contextPath}/statics/ui-frame/css/animate.min.css" rel="stylesheet">
<!-- 基本样式 -->
<link href="${rc.contextPath}/statics/ui-frame/css/style.min862f.css?v=4.1.0" rel="stylesheet">
</head>
<body class="gray-bg">
	<div id="app" class="wrapper wrapper-content" style="padding: 20px">
		<div class="row">
			<div class="col-sm-12">

				<div class="ibox float-e-margins">
					<div class="ibox-content">
						<div class="row">

							<div class="col-xs-4">
								<div class="form-group" id="date_range">
									<label class="font-noraml">日期</label>
									<div class="input-daterange input-group" id="datepicker">
										<input type="text" class="input-sm form-control" name="start" value="" />
										<span class="input-group-addon">到</span>
										<input type="text" class="input-sm form-control" name="end" value="" />
									</div>
								</div>
							</div>

							<div class="col-xs-2">
								<div class="form-group">
									<label class="font-noraml">厂商</label>
                                    <select class="form-control m-b" name="manufacturer">
										<#list manufacturers as item>
                                       		<option value="${item.value!}">${item.name!}</option>
                                        </#list>
                                    </select>
								</div>
							</div>
							
							<div class="col-xs-2">
								<div class="form-group">
									<label class="font-noraml">类型</label>
									<select class="form-control m-b" name="type">
										<#list requestHttpUrlTypes as item>
                                       		<option value="${item.value!}">${item.name!}</option>
                                        </#list>
                                    </select>
								</div>
							</div>
							
							<div class="col-xs-2">
								<div class="form-group">
									<label class="font-noraml">接入方式</label>
									<select class="form-control m-b" name="ethernet">
										<#list cacheSystemEthernets as item>
											<option value="${item.value!}">${item.name!}</option>
                                        </#list>
                                    </select>
								</div>
							</div>
							
							<div class="col-xs-2">
								<div class="form-group" style="min-width: 120px;">
									<label class="font-noraml">操作</label>
									<div class="btn-group" style="display: block;">
										<button class="btn btn-primary" type="button">搜索</button>
	                                    <button class="btn btn-white" type="button">刷新</button>
                                    </div>
								</div>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
		
		<div class="row">
			<div class="col-xs-6">
				<div class="ibox float-e-margins">
					<div class="ibox-title">
						<h5>Cache状态码分布</h5>
						<div class="ibox-tools">
							<a style="color:#273a4a"> <i class="fa fa-download"></i> 导出</a>
						</div>
					</div>
					<div class="ibox-content" style="padding-left: 0; padding-right: 0;">
						<div id="c1"></div>
					</div>
				</div>
			</div>
			<div class="col-xs-6">
				<div class="ibox float-e-margins">
					<div class="ibox-title">
						<h5>回源吐出速率</h5>
						<div class="ibox-tools">
							<a style="color:#273a4a"> <i class="fa fa-download"></i> 导出</a>
						</div>
					</div>
					<div class="ibox-content" style="padding-left: 0; padding-right: 0;">
						<div id="c2"></div>
					</div>
				</div>
			</div>
			<div class="col-xs-6">
				<div class="ibox float-e-margins">
					<div class="ibox-title">
						<h5>Cache HIT/MISS/ERR比例</h5>
						<div class="ibox-tools">
							<a style="color:#273a4a"> <i class="fa fa-download"></i> 导出</a>
						</div>
					</div>
					<div class="ibox-content" style="padding-left: 0; padding-right: 0;">
						<div id="c3"></div>
					</div>
				</div>
			</div>
			<div class="col-xs-6">
				<div class="ibox float-e-margins">
					<div class="ibox-title">
						<h5>Cache 每秒访问次数</h5>
						<div class="ibox-tools">
							<a style="color:#273a4a"> <i class="fa fa-download"></i> 导出</a>
						</div>
					</div>
					<div class="ibox-content" style="padding-left: 0; padding-right: 0;">
						<div id="c4"></div>
					</div>
				</div>
			</div>
		</div>
		
	</div>
	<!-- Jquery Dom -->
	<script src="${rc.contextPath}/statics/ui-frame/js/jquery.min.js?v=2.1.4"></script>
	<!-- BootStrap Js -->
	<script src="${rc.contextPath}/statics/ui-frame/js/bootstrap.min.js?v=3.3.6"></script>
	<!-- 日期插件 -->
	<script src="${rc.contextPath}/statics/ui-frame/js/plugins/datapicker/bootstrap-datepicker.js"></script>
	<!-- 日期格式化插件 -->
	<script src="${rc.contextPath}/statics/ui-frame/plugins/moment/moment.min.js"></script>
	<!-- 框架工具 -->
	<script src="${rc.contextPath}/statics/ui-frame/js/frame-util.js"></script>
	<!-- 图表插件 -->
	<script src="${rc.contextPath}/statics/ui-frame/plugins/antv/antv-g2-v2.3.13.js"></script>
	<script src="${rc.contextPath}/statics/ui-frame/plugins/antv/slider.js"></script>
	<script type="text/javascript">
		(function(_j) {
			
			(function() {
				var data = [
			        {value:1335,type:'状态码正常',name:'200'},
			        {value:35,type:'状态码正常',name:'201'},
			        {value:0,type:'状态码正常',name:'202'},
			        {value:0,type:'状态码正常',name:'204'},
			        {value:0,type:'状态码正常',name:'206'},
			        {value:0,type:'状态码正常',name:'300'},
			        {value:0,type:'状态码正常',name:'301'},
			        {value:0,type:'状态码正常',name:'302'},
			        {value:0,type:'状态码正常',name:'303'},
			        {value:35,type:'状态码正常',name:'304'},
			        {value:0,type:'状态码正常',name:'306'},
			        {value:0,type:'状态码正常',name:'307'},
			        {value:0,type:'状态码正常',name:'400'},
			        {value:0,type:'状态码正常',name:'401'},
			        {value:35,type:'状态码正常',name:'403'},
			        {value:35,type:'状态码异常',name:'404'},
			        {value:35,type:'状态码异常',name:'405'},
			        {value:35,type:'状态码异常',name:'415'},
			        {value:1,type:'状态码异常',name:'500'},
			        {value:0,type:'状态码异常',name:'504'}
			      ];
			      var Stat = G2.Stat;
			      var chart = new G2.Chart({
			        id: 'c1',
			        forceFit: true,
			        height: 320,
			        plotCfg: {
				        margin: [50, 50, 100, 50]
			        }
			      });
			      chart.legend('name', {
			    	   position: 'bottom',
			    	   spacingX: 50,
			    	   title: null,
			    	   itemWrap: true,
			    	   marker: 'square',
			    	   dy: 18
			      });
			      chart.legend('type', {
				    	position: 'top',
				    	title: null,
				    	itemWrap: true,
				    	marker: 'square',
				    	dy: 0
			      });
			      var viewBack = chart.createView();
			      viewBack.source(data);
			      viewBack.coord('theta', {
			        	radius: .7
			      });
			      // 绘制内部的饼图
			      viewBack.intervalStack()
				        .position(Stat.summary.percent('value'))
				        .color('type',['#4ecda5','#c82b3d']);
			      // 绘制外圈饼图
			      var view = chart.createView();
			      view.source(data);
			      view.coord('theta', {
			        	inner: 0.78 // 设置空心部分的大小
			      });
			      view.intervalStack()
				        .position(Stat.summary.percent('value'))
				        .color('name')
				        .selected({
				        mode: 'multiple'
			      });
			      chart.render();
			})();
			
			(function() {
				_j.post("${rc.contextPath}/data/line.do", function(result){
		    		if(result.status) {
						var Frame = G2.Frame;
				        var frame = new Frame(result.list);
				        frame = Frame.combinColumns(frame, ['吐出流量', '回源流量'], 'value', 'type', 'date'); 
				        var chart = new G2.Chart({
				          id: 'c2',
				          forceFit: true,
				          height: 320,
				          plotCfg: {
				            margin: [20, 50, 130, 100]
				          }
				        });
				        chart.source(frame, {
				          date: {
				            type: 'time',
				            mask: 'yyyy-mm-dd HH:MM:ss',
				            tickCount: 5
				          },
				          value: {
				            alias: '速度 (Mpbs)'
				          }
				        });
				        chart.legend({
					            position: 'bottom',
						    	marker: 'square',
						    	dy: 13
				        });
				        chart.axis('date', {
					          tickLine: {
					            stroke: '#000',
					            value: 3 // 刻度线长度
					          },
					          line: {
					            stroke: '#000'
					          },
					          title: null
				        });
				        chart.axis('value', {
				          tickLine: {
				            stroke: '#000',
				            value: 3 // 刻度线长度
				          },
				          labels: {
				            label: {
				              fill: '#000'
				            }
				          },
				          line: {
				            stroke: '#000'
				          },
				          grid: null
				        });
				        chart.line().position('date*value').color('type', ['#1f77b4', '#ff7f0e']).shape('line').size(2);
				        chart.render();
		    		}
		    	}, "json");
			})();
			
			(function() {
				var data = [
			        {name: 'MISS', value: 56.33 },
			        {name: 'HIT', value: 24.03},
			        {name: 'ERROR', value: 4.03}
			      ];
			      var Stat = G2.Stat;
			      var chart = new G2.Chart({
			          id: 'c3',
			          forceFit: true,
			          height: 260,
			          plotCfg: {
			            margin: [30, 50, 70, 50]
			          }
			      });
			      chart.source(data);
			      chart.coord('theta', {
			        radius: 0.8 // 设置饼图的大小
			      });
			      chart.legend('name', {
			        position: 'bottom',
			    	marker: 'square'
			      });
			      chart.tooltip({
			        title: null,
			        map: {
			          value: 'value'
			        }
			      });
			      chart.intervalStack()
			        .position(Stat.summary.percent('value'))
			        .color('name')
			        .label('name*..percent',function(name, percent){
			        percent = (percent * 100).toFixed(2) + '%';
			        return name + ' ' + percent;
			      });
			      chart.render();
			})();
			
			(function() {
				var data = [
			        {date: '2011-10-11 11:11:11', visitCount: 7},
			        {date: '2011-10-11 11:11:12', visitCount: 6},
			        {date: '2011-10-11 11:11:13', visitCount: 9},
			        {date: '2011-10-11 11:11:14', visitCount: 14},
			        {date: '2011-10-11 11:11:15', visitCount: 12},
			        {date: '2011-10-11 11:11:16', visitCount: 25},
			        {date: '2011-10-11 11:11:17', visitCount: 22},
			        {date: '2011-10-11 11:11:18', visitCount: 26},
			        {date: '2011-10-11 11:11:19', visitCount: 23},
			        {date: '2011-10-11 11:11:20', visitCount: 18},
			        {date: '2011-10-11 11:11:21', visitCount: 13},
			        {date: '2011-10-11 11:11:22', visitCount: 6}
			      ];
			      var chart = new G2.Chart({
			        id: 'c4',
			        forceFit: true,
			        height: 260,
		            plotCfg: {
			            margin: [20, 50, 46, 90]
			        }
			      });
			      chart.source(data, {
			    	    date: {
					        mask: 'HH:MM:ss',
				            tickCount: 6
				        },
				        visitCount: {
				            alias: '访问次数'
				        }
			      });
			      chart.axis('date', {
			    	  title: null 
			      });
			      chart.line().position('date*visitCount').size(2);
			      chart.render();
			})();
			
			// 日期控件初始化
			_j("#date_range .input-daterange").datepicker({
				keyboardNavigation : !1,
				forceParse : !1,
				autoclose : !0
			});
		})(jQuery)
	</script>
</body>
</html>